<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>DJ Calendar PRO+ - Gestion de Planning</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { 
            background: #0f172a; 
            color: white; 
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Calendrier responsive */
        .calendar-day { 
            min-height: 80px; 
            border: 1px solid #334155;
        }
        .week-day { 
            min-height: 100px; 
            border: 1px solid #334155;
        }
        
        /* Mobile: calendrier plus compact */
        @media (max-width: 768px ) {
            .calendar-day { min-height: 60px; }
            .week-day { min-height: 80px; }
        }
        
        /* √âv√©nements responsive */
        .event-confirmed { opacity: 1; }
        .event-pending { opacity: 0.8; border: 2px dashed #fbbf24; }
        .event-cancelled { opacity: 0.6; filter: grayscale(50%); }
        
        .event-club { background: linear-gradient(135deg, #7c3aed, #a855f7); }
        .event-festival { background: linear-gradient(135deg, #dc2626, #ef4444); }
        .event-wedding { background: linear-gradient(135deg, #ec4899, #f472b6); }
        .event-private { background: linear-gradient(135deg, #2563eb, #3b82f6); }
        .event-corporate { background: linear-gradient(135deg, #ea580c, #f97316); }
        
        .event-item { 
            cursor: pointer; 
            transition: all 0.2s;
            border-radius: 4px;
            margin: 1px;
            padding: 2px 4px;
            font-size: 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* Mobile: √©v√©nements plus gros */
        @media (max-width: 768px) {
            .event-item { 
                font-size: 11px;
                padding: 3px 6px;
                margin: 2px 1px;
            }
        }
        
        .event-item:hover { 
            transform: scale(1.02); 
            z-index: 10;
            position: relative;
        }
        
        /* Modal responsive */
        .modal-overlay { 
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(4px);
        }
        
        /* Mobile: modal plein √©cran */
        @media (max-width: 768px) {
            .modal-content {
                width: 100vw !important;
                height: 100vh !important;
                max-width: none !important;
                max-height: none !important;
                border-radius: 0 !important;
                margin: 0 !important;
            }
        }
        
        /* Boutons tactiles */
        .btn-touch {
            min-height: 44px;
            min-width: 44px;
            touch-action: manipulation;
        }
        
        /* Navigation mobile */
        @media (max-width: 768px) {
            .mobile-nav {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: #1e293b;
                border-top: 1px solid #334155;
                z-index: 50;
                padding: 8px;
            }
            
            .main-content {
                padding-bottom: 80px;
            }
        }
        
        /* Graphiques responsive */
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        @media (max-width: 768px) {
            .chart-container {
                height: 250px;
            }
        }
        
        /* Formulaire mobile */
        @media (max-width: 768px) {
            .form-input {
                font-size: 16px; /* √âvite le zoom sur iOS */
            }
        }
        
        /* Swipe indicators */
        .swipe-indicator {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .swipe-indicator:hover {
            background: rgba(255,255,255,0.2);
        }
        
        @media (max-width: 768px) {
            .swipe-indicator {
                width: 35px;
                height: 35px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [events, setEvents] = useState([]);
            const [currentDate, setCurrentDate] = useState(new Date());
            const [showModal, setShowModal] = useState(false);
            const [editingEvent, setEditingEvent] = useState(null);
            const [viewMode, setViewMode] = useState('month');
            const [activeTab, setActiveTab] = useState('calendar');
            const [stats, setStats] = useState({});
            const [analytics, setAnalytics] = useState({});
            const [searchTerm, setSearchTerm] = useState('');
            const [filterType, setFilterType] = useState('');
            const [filterStatus, setFilterStatus] = useState('');
            const [isMobile, setIsMobile] = useState(false);

            // D√©tection mobile
            useEffect(() => {
                const checkMobile = () => {
                    setIsMobile(window.innerWidth <= 768);
                };
                checkMobile();
                window.addEventListener('resize', checkMobile);
                return () => window.removeEventListener('resize', checkMobile);
            }, []);

            const loadEvents = async () => {
                try {
                    const params = new URLSearchParams();
                    if (searchTerm) params.append('search', searchTerm);
                    if (filterType) params.append('type', filterType);
                    if (filterStatus) params.append('status', filterStatus);
                    
                    const response = await fetch(`/api/events?${params}`);
                    const data = await response.json();
                    if (data.success) {
                        setEvents(data.events);
                    }
                } catch (error) {
                    console.error('Erreur chargement √©v√©nements:', error);
                }
            };

            const loadStats = async () => {
                try {
                    const response = await fetch('/api/events/stats');
                    const data = await response.json();
                    if (data.success) {
                        setStats(data.stats);
                    }
                } catch (error) {
                    console.error('Erreur chargement stats:', error);
                }
            };

            const loadAnalytics = async () => {
                try {
                    const response = await fetch('/api/events/analytics');
                    const data = await response.json();
                    if (data.success) {
                        setAnalytics(data.analytics);
                    }
                } catch (error) {
                    console.error('Erreur chargement analytics:', error);
                }
            };

            useEffect(() => {
                loadEvents();
                loadStats();
                loadAnalytics();
            }, [searchTerm, filterType, filterStatus]);

            const createEvent = async (eventData) => {
                try {
                    console.log('Envoi des donn√©es:', eventData);
                    const response = await fetch('/api/events', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(eventData)
                    });
                    const data = await response.json();
                    console.log('R√©ponse re√ßue:', data);
                    
                    if (data.success) {
                        await loadEvents();
                        await loadStats();
                        await loadAnalytics();
                        setShowModal(false);
                        setEditingEvent(null);
                        if (isMobile) {
                            alert('‚úÖ √âv√©nement cr√©√© !');
                        }
                    } else {
                        alert('‚ùå Erreur: ' + (data.error || 'Erreur inconnue'));
                    }
                } catch (error) {
                    console.error('Erreur cr√©ation:', error);
                    alert('‚ùå Erreur lors de la cr√©ation: ' + error.message);
                }
            };

            const updateEvent = async (eventId, eventData) => {
                try {
                    const response = await fetch(`/api/events/${eventId}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(eventData)
                    });
                    const data = await response.json();
                    
                    if (data.success) {
                        await loadEvents();
                        await loadStats();
                        await loadAnalytics();
                        setShowModal(false);
                        setEditingEvent(null);
                        if (isMobile) {
                            alert('‚úÖ √âv√©nement modifi√© !');
                        }
                    } else {
                        alert('‚ùå Erreur: ' + (data.error || 'Erreur inconnue'));
                    }
                } catch (error) {
                    console.error('Erreur modification:', error);
                    alert('‚ùå Erreur lors de la modification');
                }
            };

            const deleteEvent = async (eventId) => {
                const confirmDelete = isMobile ? 
                    confirm('Supprimer cet √©v√©nement ?') :
                    window.confirm('√ätes-vous s√ªr de vouloir supprimer cet √©v√©nement ?');
                    
                if (!confirmDelete) return;

                try {
                    const response = await fetch(`/api/events/${eventId}`, {
                        method: 'DELETE'
                    });
                    const data = await response.json();
                    
                    if (data.success) {
                        await loadEvents();
                        await loadStats();
                        await loadAnalytics();
                        setShowModal(false);
                        setEditingEvent(null);
                        if (isMobile) {
                            alert('‚úÖ √âv√©nement supprim√© !');
                        }
                    }
                } catch (error) {
                    console.error('Erreur suppression:', error);
                    alert('‚ùå Erreur lors de la suppression');
                }
            };

            const getEventIcon = (type) => {
                const icons = {
                    club: 'üéß',
                    festival: 'üé™',
                    wedding: 'üíí',
                    private: 'üè†',
                    corporate: 'üè¢'
                };
                return icons[type] || 'üéµ';
            };

            const getEventClass = (event) => {
                const typeClass = `event-${event.type}`;
                const statusClass = `event-${event.status}`;
                return `event-item ${typeClass} ${statusClass}`;
            };

            const formatDate = (dateStr) => {
                const date = new Date(dateStr + 'T00:00:00');
                return date.toLocaleDateString('fr-FR', { 
                    day: '2-digit', 
                    month: '2-digit' 
                });
            };

            const getDaysInMonth = (date) => {
                const year = date.getFullYear();
                const month = date.getMonth();
                const firstDay = new Date(year, month, 1);
                const lastDay = new Date(year, month + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startingDayOfWeek = firstDay.getDay();
                
                const days = [];
                
                // Jours du mois pr√©c√©dent
                for (let i = startingDayOfWeek - 1; i >= 0; i--) {
                    const prevDate = new Date(year, month, -i);
                    days.push({ date: prevDate, isCurrentMonth: false });
                }
                
                // Jours du mois actuel
                for (let day = 1; day <= daysInMonth; day++) {
                    const currentDate = new Date(year, month, day);
                    days.push({ date: currentDate, isCurrentMonth: true });
                }
                
                // Jours du mois suivant pour compl√©ter la grille
                const remainingDays = 42 - days.length;
                for (let day = 1; day <= remainingDays; day++) {
                    const nextDate = new Date(year, month + 1, day);
                    days.push({ date: nextDate, isCurrentMonth: false });
                }
                
                return days;
            };

            const getWeekDays = (date) => {
                const startOfWeek = new Date(date);
                const day = startOfWeek.getDay();
                const diff = startOfWeek.getDate() - day + (day === 0 ? -6 : 1);
                startOfWeek.setDate(diff);
                
                const days = [];
                for (let i = 0; i < 7; i++) {
                    const currentDate = new Date(startOfWeek);
                    currentDate.setDate(startOfWeek.getDate() + i);
                    days.push(currentDate);
                }
                return days;
            };

            const getEventsForDate = (date) => {
                const dateStr = date.toISOString().split('T')[0];
                return events.filter(event => event.date === dateStr);
            };

            const navigateMonth = (direction) => {
                const newDate = new Date(currentDate);
                newDate.setMonth(newDate.getMonth() + direction);
                setCurrentDate(newDate);
            };

            const navigateWeek = (direction) => {
                const newDate = new Date(currentDate);
                newDate.setDate(newDate.getDate() + (direction * 7));
                setCurrentDate(newDate);
            };

            const resetFilters = () => {
                setSearchTerm('');
                setFilterType('');
                setFilterStatus('');
            };

            const renderCalendarView = () => {
                if (viewMode === 'month') {
                    const days = getDaysInMonth(currentDate);
                    const monthName = currentDate.toLocaleDateString('fr-FR', { month: 'long', year: 'numeric' });
                    
                    return (
                        <div className="bg-slate-800 rounded-lg p-4">
                            <div className="flex items-center justify-between mb-4 relative">
                                <button 
                                    onClick={() => navigateMonth(-1)}
                                    className="swipe-indicator left-0 btn-touch"
                                >
                                    ‚Üê
                                </button>
                                <h2 className="text-xl font-bold capitalize text-center flex-1">
                                    {monthName}
                                </h2>
                                <button 
                                    onClick={() => navigateMonth(1)}
                                    className="swipe-indicator right-0 btn-touch"
                                >
                                    ‚Üí
                                </button>
                            </div>
                            
                            <div className="grid grid-cols-7 gap-1 mb-2">
                                {['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'].map(day => (
                                    <div key={day} className="text-center font-semibold text-slate-400 p-2 text-sm">
                                        {isMobile ? day.charAt(0) : day}
                                    </div>
                                ))}
                            </div>
                            
                            <div className="grid grid-cols-7 gap-1">
                                {days.map((day, index) => {
                                    const dayEvents = getEventsForDate(day.date);
                                    const isToday = day.date.toDateString() === new Date().toDateString();
                                    
                                    return (
                                        <div 
                                            key={index} 
                                            className={`calendar-day p-1 ${
                                                day.isCurrentMonth ? 'bg-slate-700' : 'bg-slate-800 opacity-50'
                                            } ${isToday ? 'ring-2 ring-purple-500' : ''}`}
                                        >
                                            <div className={`text-sm font-medium mb-1 ${
                                                isToday ? 'text-purple-400' : 'text-white'
                                            }`}>
                                                {day.date.getDate()}
                                            </div>
                                            <div className="space-y-1">
                                                {dayEvents.slice(0, isMobile ? 2 : 3).map(event => (
                                                    <div
                                                        key={event.id}
                                                        className={getEventClass(event)}
                                                        onClick={() => {
                                                            setEditingEvent(event);
                                                            setShowModal(true);
                                                        }}
                                                        title={`${event.title} - ${event.venueName} (${event.startTime})`}
                                                    >
                                                        <span className="mr-1">{getEventIcon(event.type)}</span>
                                                        {isMobile ? event.title.substring(0, 8) + '...' : event.title}
                                                    </div>
                                                ))}
                                                {dayEvents.length > (isMobile ? 2 : 3) && (
                                                    <div className="text-xs text-slate-400">
                                                        +{dayEvents.length - (isMobile ? 2 : 3)} autres
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    );
                } else {
                    const weekDays = getWeekDays(currentDate);
                    const weekStart = weekDays[0].toLocaleDateString('fr-FR', { day: '2-digit', month: 'short' });
                    const weekEnd = weekDays[6].toLocaleDateString('fr-FR', { day: '2-digit', month: 'short' });
                    
                    return (
                        <div className="bg-slate-800 rounded-lg p-4">
                            <div className="flex items-center justify-between mb-4 relative">
                                <button 
                                    onClick={() => navigateWeek(-1)}
                                    className="swipe-indicator left-0 btn-touch"
                                >
                                    ‚Üê
                                </button>
                                <h2 className="text-xl font-bold text-center flex-1">
                                    {weekStart} - {weekEnd}
                                </h2>
                                <button 
                                    onClick={() => navigateWeek(1)}
                                    className="swipe-indicator right-0 btn-touch"
                                >
                                    ‚Üí
                                </button>
                            </div>
                            
                            <div className="grid grid-cols-7 gap-1">
                                {weekDays.map((day, index) => {
                                    const dayEvents = getEventsForDate(day);
                                    const isToday = day.toDateString() === new Date().toDateString();
                                    const dayName = day.toLocaleDateString('fr-FR', { weekday: 'short' });
                                    
                                    return (
                                        <div key={index} className={`week-day p-2 bg-slate-700 ${
                                            isToday ? 'ring-2 ring-purple-500' : ''
                                        }`}>
                                            <div className={`text-center mb-2 ${
                                                isToday ? 'text-purple-400' : 'text-white'
                                            }`}>
                                                <div className="font-semibold text-sm">
                                                    {isMobile ? dayName.charAt(0) : dayName}
                                                </div>
                                                <div className="text-lg font-bold">
                                                    {day.getDate()}
                                                </div>
                                            </div>
                                            <div className="space-y-1">
                                                {dayEvents.map(event => (
                                                    <div
                                                        key={event.id}
                                                        className={getEventClass(event)}
                                                        onClick={() => {
                                                            setEditingEvent(event);
                                                            setShowModal(true);
                                                        }}
                                                        title={`${event.title} - ${event.venueName} (${event.startTime})`}
                                                    >
                                                        <div className="font-medium">
                                                            <span className="mr-1">{getEventIcon(event.type)}</span>
                                                            {isMobile ? event.title.substring(0, 10) + '...' : event.title}
                                                        </div>
                                                        <div className="text-xs opacity-90">
                                                            {event.startTime} - {event.venueName}
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    );
                }
            };

            const renderAnalytics = () => {
                return (
                    <div className="space-y-6">
                        <div className="bg-slate-800 rounded-lg p-6">
                            <h3 className="text-xl font-bold mb-4">üìä Analytics</h3>
                            <div className="text-center text-slate-400">
                                <p>Graphiques disponibles prochainement</p>
                                <p className="text-sm mt-2">En cours de d√©veloppement...</p>
                            </div>
                        </div>
                    </div>
                );
            };

            return (
                <div className={`min-h-screen bg-slate-900 ${isMobile ? 'main-content' : ''}`}>
                    {/* Header */}
                    <div className="bg-slate-800 border-b border-slate-700 p-4">
                        <div className="flex items-center justify-between">
                            <h1 className="text-2xl font-bold text-purple-400">
                                üéµ DJ Calendar {isMobile ? '' : 'PRO+'}
                            </h1>
                            {!isMobile && (
                                <button
                                    onClick={() => setShowModal(true)}
                                    className="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg font-medium btn-touch"
                                >
                                    ‚ûï Nouvel √©v√©nement
                                </button>
                            )}
                        </div>
                        
                        {/* Navigation tabs - Desktop */}
                        {!isMobile && (
                            <div className="flex space-x-4 mt-4">
                                <button
                                    onClick={() => setActiveTab('calendar')}
                                    className={`px-4 py-2 rounded-lg font-medium btn-touch ${
                                        activeTab === 'calendar' ? 'bg-purple-600 text-white' : 'bg-slate-700 text-slate-300'
                                    }`}
                                >
                                    üìÖ Calendrier
                                </button>
                                <button
                                    onClick={() => setActiveTab('analytics')}
                                    className={`px-4 py-2 rounded-lg font-medium btn-touch ${
                                        activeTab === 'analytics' ? 'bg-purple-600 text-white' : 'bg-slate-700 text-slate-300'
                                    }`}
                                >
                                    üìä Analytics
                                </button>
                            </div>
                        )}
                    </div>

                    {/* Main Content */}
                    <div className="p-4">
                        {activeTab === 'calendar' && (
                            <>
                                {/* Statistiques */}
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                                    <div className="bg-slate-800 rounded-lg p-4 text-center">
                                        <div className="text-2xl font-bold text-purple-400">
                                            {stats.total_events || 0}
                                        </div>
                                        <div className="text-sm text-slate-400">
                                            {isMobile ? 'Total' : '√âv√©nements'}
                                        </div>
                                    </div>
                                    <div className="bg-slate-800 rounded-lg p-4 text-center">
                                        <div className="text-2xl font-bold text-green-400">
                                            {stats.confirmed_events || 0}
                                        </div>
                                        <div className="text-sm text-slate-400">
                                            {isMobile ? 'Confirm√©s' : 'Confirm√©s'}
                                        </div>
                                    </div>
                                    <div className="bg-slate-800 rounded-lg p-4 text-center">
                                        <div className="text-2xl font-bold text-yellow-400">
                                            {stats.pending_events || 0}
                                        </div>
                                        <div className="text-sm text-slate-400">
                                            {isMobile ? 'Attente' : 'En attente'}
                                        </div>
                                    </div>
                                    <div className="bg-slate-800 rounded-lg p-4 text-center">
                                        <div className="text-2xl font-bold text-blue-400">
                                            {stats.total_revenue || 0}‚Ç¨
                                        </div>
                                        <div className="text-sm text-slate-400">
                                            {isMobile ? 'Revenus' : 'Revenus'}
                                        </div>
                                    </div>
                                </div>

                                {/* Recherche et filtres */}
                                <div className="bg-slate-800 rounded-lg p-4 mb-6">
                                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                        <input
                                            type="text"
                                            placeholder="üîç Rechercher..."
                                            className="form-input bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white btn-touch"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                        />
                                        <select
                                            className="form-input bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white btn-touch"
                                            value={filterType}
                                            onChange={(e) => setFilterType(e.target.value)}
                                        >
                                            <option value="">Tous les types</option>
                                            <option value="club">üéß Club</option>
                                            <option value="festival">üé™ Festival</option>
                                            <option value="wedding">üíí Mariage</option>
                                            <option value="private">üè† Priv√©</option>
                                            <option value="corporate">üè¢ Corporate</option>
                                        </select>
                                        <select
                                            className="form-input bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-white btn-touch"
                                            value={filterStatus}
                                            onChange={(e) => setFilterStatus(e.target.value)}
                                        >
                                            <option value="">Tous les statuts</option>
                                            <option value="confirmed">‚úÖ Confirm√©</option>
                                            <option value="pending">‚è≥ En attente</option>
                                            <option value="cancelled">‚ùå Annul√©</option>
                                        </select>
                                        <button
                                            onClick={resetFilters}
                                            className="bg-slate-600 hover:bg-slate-500 px-4 py-2 rounded-lg text-white btn-touch"
                                        >
                                            üîÑ Reset
                                        </button>
                                    </div>
                                </div>

                                {/* Contr√¥les de vue */}
                                <div className="flex items-center justify-between mb-6">
                                    <div className="flex space-x-2">
                                        <button
                                            onClick={() => setViewMode('month')}
                                            className={`px-4 py-2 rounded-lg font-medium btn-touch ${
                                                viewMode === 'month' ? 'bg-purple-600 text-white' : 'bg-slate-700 text-slate-300'
                                            }`}
                                        >
                                            {isMobile ? 'üìÖ' : 'üìÖ Mois'}
                                        </button>
                                        <button
                                            onClick={() => setViewMode('week')}
                                            className={`px-4 py-2 rounded-lg font-medium btn-touch ${
                                                viewMode === 'week' ? 'bg-purple-600 text-white' : 'bg-slate-700 text-slate-300'
                                            }`}
                                        >
                                            {isMobile ? 'üìã' : 'üìã Semaine'}
                                        </button>
                                    </div>
                                    
                                    {/* L√©gendes */}
                                    {!isMobile && (
                                        <div className="flex space-x-4 text-sm">
                                            <div className="flex items-center space-x-2">
                                                <div className="w-3 h-3 bg-green-500 rounded"></div>
                                                <span>Confirm√©</span>
                                            </div>
                                            <div className="flex items-center space-x-2">
                                                <div className="w-3 h-3 bg-yellow-500 rounded border-2 border-dashed border-yellow-300"></div>
                                                <span>En attente</span>
                                            </div>
                                            <div className="flex items-center space-x-2">
                                                <div className="w-3 h-3 bg-gray-500 rounded"></div>
                                                <span>Annul√©</span>
                                            </div>
                                        </div>
                                    )}
                                </div>

                                {/* Calendrier */}
                                {renderCalendarView()}
                            </>
                        )}

                        {activeTab === 'analytics' && renderAnalytics()}
                    </div>

                    {/* Navigation mobile */}
                    {isMobile && (
                        <div className="mobile-nav">
                            <div className="flex justify-around items-center">
                                <button
                                    onClick={() => setActiveTab('calendar')}
                                    className={`flex flex-col items-center p-2 rounded-lg btn-touch ${
                                        activeTab === 'calendar' ? 'text-purple-400' : 'text-slate-400'
                                    }`}
                                >
                                    <span className="text-xl">üìÖ</span>
                                    <span className="text-xs">Calendrier</span>
                                </button>
                                <button
                                    onClick={() => setShowModal(true)}
                                    className="bg-purple-600 hover:bg-purple-700 p-3 rounded-full btn-touch"
                                >
                                    <span className="text-xl">‚ûï</span>
                                </button>
                                <button
                                    onClick={() => setActiveTab('analytics')}
                                    className={`flex flex-col items-center p-2 rounded-lg btn-touch ${
                                        activeTab === 'analytics' ? 'text-purple-400' : 'text-slate-400'
                                    }`}
                                >
                                    <span className="text-xl">üìä</span>
                                    <span className="text-xs">Analytics</span>
                                </button>
                            </div>
                        </div>
                    )}

                    {/* Modal */}
                    {showModal && (
                        <EventModal
                            event={editingEvent}
                            onSave={editingEvent ? 
                                (data) => updateEvent(editingEvent.id, data) : 
                                createEvent
                            }
                            onDelete={editingEvent ? () => deleteEvent(editingEvent.id) : null}
                            onClose={() => {
                                setShowModal(false);
                                setEditingEvent(null);
                            }}
                            isMobile={isMobile}
                        />
                    )}
                </div>
            );
        }

        function EventModal({ event, onSave, onDelete, onClose, isMobile }) {
            const [activeTab, setActiveTab] = useState('basic');
            const [formData, setFormData] = useState({
                title: event?.title || '',
                date: event?.date || '',
                startTime: event?.startTime || '',
                endTime: event?.endTime || '',
                venueName: event?.venueName || '',
                venueAddress: event?.venueAddress || '',
                fee: event?.fee || '',
                currency: event?.currency || 'EUR',
                status: event?.status || 'confirmed',
                type: event?.type || 'club',
                notes: event?.notes || '',
                techEquipment: event?.techEquipment || '',
                techSetup: event?.techSetup || '',
                techPlaylist: event?.techPlaylist || '',
                techSetupTime: event?.techSetupTime || '',
                techNotes: event?.techNotes || ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
            };

            return (
                <div className="modal-overlay fixed inset-0 flex items-center justify-center z-50 p-4">
                    <div className={`modal-content bg-slate-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden ${
                        isMobile ? 'h-full' : ''
                    }`}>
                        {/* Header */}
                        <div className="flex items-center justify-between p-4 border-b border-slate-700">
                            <h3 className="text-xl font-bold">
                                {event ? '‚úèÔ∏è Modifier l\'√©v√©nement' : '‚ûï Nouvel √©v√©nement'}
                            </h3>
                            <button
                                onClick={onClose}
                                className="text-slate-400 hover:text-white btn-touch"
                            >
                                ‚úï
                            </button>
                        </div>

                        {/* Tabs */}
                        <div className="flex border-b border-slate-700">
                            <button
                                onClick={() => setActiveTab('basic')}
                                className={`flex-1 px-4 py-3 font-medium btn-touch ${
                                    activeTab === 'basic' ? 'bg-purple-600 text-white' : 'text-slate-300'
                                }`}
                            >
                                üìù {isMobile ? 'Infos' : 'Infos de base'}
                            </button>
                            <button
                                onClick={() => setActiveTab('dj')}
                                className={`flex-1 px-4 py-3 font-medium btn-touch ${
                                    activeTab === 'dj' ? 'bg-purple-600 text-white' : 'text-slate-300'
                                }`}
                            >
                                üéß {isMobile ? 'DJ' : 'Notes DJ'}
                            </button>
                        </div>

                        {/* Content */}
                        <div className="p-4 overflow-y-auto flex-1">
                            <form onSubmit={handleSubmit} className="space-y-4">
                                {activeTab === 'basic' && (
                                    <>
                                        <input 
                                            type="text" 
                                            placeholder="Nom de l'√©v√©nement *" 
                                            required
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                            value={formData.title} 
                                            onChange={(e) => setFormData({...formData, title: e.target.value})}
                                        />
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <input 
                                                type="date" 
                                                required
                                                className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                                value={formData.date} 
                                                onChange={(e) => setFormData({...formData, date: e.target.value})}
                                            />
                                            <select
                                                className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                                value={formData.status}
                                                onChange={(e) => setFormData({...formData, status: e.target.value})}
                                            >
                                                <option value="confirmed">‚úÖ Confirm√©</option>
                                                <option value="pending">‚è≥ En attente</option>
                                                <option value="cancelled">‚ùå Annul√©</option>
                                            </select>
                                        </div>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <input 
                                                type="time" 
                                                placeholder="Heure d√©but *" 
                                                required
                                                className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                                value={formData.startTime} 
                                                onChange={(e) => setFormData({...formData, startTime: e.target.value})}
                                            />
                                            <input 
                                                type="time" 
                                                placeholder="Heure fin"
                                                className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                                value={formData.endTime} 
                                                onChange={(e) => setFormData({...formData, endTime: e.target.value})}
                                            />
                                        </div>
                                        
                                        <input 
                                            type="text" 
                                            placeholder="Nom du lieu *" 
                                            required
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                            value={formData.venueName} 
                                            onChange={(e) => setFormData({...formData, venueName: e.target.value})}
                                        />
                                        
                                        <input 
                                            type="text" 
                                            placeholder="Adresse du lieu"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                            value={formData.venueAddress} 
                                            onChange={(e) => setFormData({...formData, venueAddress: e.target.value})}
                                        />
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <input 
                                                type="number" 
                                                placeholder="Cachet *" 
                                                required
                                                className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                                value={formData.fee} 
                                                onChange={(e) => setFormData({...formData, fee: e.target.value})}
                                            />
                                            <select
                                                className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                                value={formData.type}
                                                onChange={(e) => setFormData({...formData, type: e.target.value})}
                                            >
                                                <option value="club">üéß Club</option>
                                                <option value="festival">üé™ Festival</option>
                                                <option value="wedding">üíí Mariage</option>
                                                <option value="private">üè† Priv√©</option>
                                                <option value="corporate">üè¢ Corporate</option>
                                            </select>
                                        </div>
                                        
                                        <textarea 
                                            placeholder="Notes g√©n√©rales"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white h-20 btn-touch"
                                            value={formData.notes} 
                                            onChange={(e) => setFormData({...formData, notes: e.target.value})}
                                        />
                                    </>
                                )}

                                {activeTab === 'dj' && (
                                    <>
                                        <textarea 
                                            placeholder="üéõÔ∏è Mat√©riel n√©cessaire (ex: CDJ 2000, Table Pioneer...)"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white h-20 btn-touch"
                                            value={formData.techEquipment} 
                                            onChange={(e) => setFormData({...formData, techEquipment: e.target.value})}
                                        />
                                        <textarea 
                                            placeholder="üîß Setup technique (ex: 2 enceintes + caisson...)"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white h-20 btn-touch"
                                            value={formData.techSetup} 
                                            onChange={(e) => setFormData({...formData, techSetup: e.target.value})}
                                        />
                                        <textarea 
                                            placeholder="üéµ Playlist/Genre musical (ex: House, Techno, Commercial...)"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white h-20 btn-touch"
                                            value={formData.techPlaylist} 
                                            onChange={(e) => setFormData({...formData, techPlaylist: e.target.value})}
                                        />
                                        <input 
                                            type="number" 
                                            placeholder="‚è±Ô∏è Temps de setup (minutes)"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white btn-touch"
                                            value={formData.techSetupTime} 
                                            onChange={(e) => setFormData({...formData, techSetupTime: e.target.value})}
                                        />
                                        <textarea 
                                            placeholder="üìù Notes techniques sp√©ciales"
                                            className="form-input w-full p-3 bg-slate-700 rounded text-white h-20 btn-touch"
                                            value={formData.techNotes} 
                                            onChange={(e) => setFormData({...formData, techNotes: e.target.value})}
                                        />
                                    </>
                                )}

                                {/* Buttons */}
                                <div className="flex gap-2 pt-4">
                                    {event && onDelete && (
                                        <button 
                                            type="button" 
                                            onClick={onDelete}
                                            className="flex-1 bg-red-600 hover:bg-red-700 py-3 rounded text-white font-medium btn-touch"
                                        >
                                            üóëÔ∏è Supprimer
                                        </button>
                                    )}
                                    <button 
                                        type="button" 
                                        onClick={onClose} 
                                        className="flex-1 bg-slate-600 hover:bg-slate-500 py-3 rounded text-white font-medium btn-touch"
                                    >
                                        Annuler
                                    </button>
                                    <button 
                                        type="submit" 
                                        className="flex-1 bg-purple-600 hover:bg-purple-700 py-3 rounded text-white font-medium btn-touch"
                                    >
                                        {event ? '‚úèÔ∏è Modifier' : '‚ûï Cr√©er'}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
