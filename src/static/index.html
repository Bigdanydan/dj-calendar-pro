<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DJ Calendar PRO+ - Gestion de Planning</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: #0f172a; color: white; font-family: 'Inter', sans-serif; }
        .calendar-day { min-height: 100px; border: 1px solid #334155; }
        .week-day { min-height: 120px; border: 1px solid #334155; }
        
        .event-confirmed { opacity: 1; }
        .event-pending { opacity: 0.8; border: 2px dashed #fbbf24; }
        .event-cancelled { opacity: 0.6; filter: grayscale(50% ); }
        
        .event-club { background: linear-gradient(135deg, #7c3aed, #a855f7); }
        .event-festival { background: linear-gradient(135deg, #dc2626, #ef4444); }
        .event-wedding { background: linear-gradient(135deg, #ec4899, #f472b6); }
        .event-private { background: linear-gradient(135deg, #2563eb, #3b82f6); }
        .event-corporate { background: linear-gradient(135deg, #ea580c, #f97316); }
        
        .modal-overlay { background: rgba(0,0,0,0.8); }
        .event-item:hover { transform: scale(1.05); transition: all 0.2s; cursor: pointer; }
        .view-button.active { background: #7c3aed; }
        .view-button { background: #475569; }
        .tab-button.active { background: #7c3aed; color: white; }
        .tab-button { background: #374151; color: #9ca3af; }
        .chart-container { background: #1e293b; border-radius: 0.5rem; padding: 1rem; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function App() {
            const [events, setEvents] = useState([]);
            const [currentDate, setCurrentDate] = useState(new Date());
            const [showModal, setShowModal] = useState(false);
            const [showEventDetail, setShowEventDetail] = useState(false);
            const [editingEvent, setEditingEvent] = useState(null);
            const [selectedEvent, setSelectedEvent] = useState(null);
            const [stats, setStats] = useState({});
            const [analytics, setAnalytics] = useState({});
            const [viewMode, setViewMode] = useState('month');
            const [activeTab, setActiveTab] = useState('calendar');
            const [searchTerm, setSearchTerm] = useState('');
            const [filterType, setFilterType] = useState('');
            const [filterStatus, setFilterStatus] = useState('');

            const loadEvents = async () => {
                try {
                    const params = new URLSearchParams();
                    if (searchTerm) params.append('search', searchTerm);
                    if (filterType) params.append('type', filterType);
                    if (filterStatus) params.append('status', filterStatus);
                    
                    const response = await fetch(`/api/events?${params}`);
                    const data = await response.json();
                    console.log('Events loaded:', data);
                    if (data.success) {
                        setEvents(data.events);
                    }
                } catch (error) {
                    console.error('Erreur loadEvents:', error);
                }
            };

            const loadStats = async () => {
                try {
                    const response = await fetch('/api/events/stats');
                    const data = await response.json();
                    if (data.success) {
                        setStats(data.stats);
                    }
                } catch (error) {
                    console.error('Erreur stats:', error);
                }
            };

            const loadAnalytics = async () => {
                try {
                    const response = await fetch('/api/events/analytics');
                    const data = await response.json();
                    if (data.success) {
                        setAnalytics(data.analytics);
                    }
                } catch (error) {
                    console.error('Erreur analytics:', error);
                }
            };

            useEffect(() => {
                loadEvents();
                loadStats();
                loadAnalytics();
            }, [searchTerm, filterType, filterStatus]);

            const createEvent = async (eventData) => {
                try {
                    console.log('CrÃ©ation Ã©vÃ©nement:', eventData);
                    const response = await fetch('/api/events', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(eventData)
                    });
                    const data = await response.json();
                    console.log('RÃ©ponse crÃ©ation:', data);
                    
                    if (data.success) {
                        setShowModal(false);
                        setEditingEvent(null);
                        alert('âœ… Ã‰vÃ©nement crÃ©Ã© avec succÃ¨s !');
                        // Recharger toutes les donnÃ©es
                        await loadEvents();
                        await loadStats();
                        await loadAnalytics();
                    } else {
                        alert('âŒ Erreur: ' + (data.error || 'Erreur inconnue'));
                    }
                } catch (error) {
                    console.error('Erreur crÃ©ation:', error);
                    alert('âŒ Erreur lors de la crÃ©ation: ' + error.message);
                }
            };

            const updateEvent = async (eventData) => {
                try {
                    console.log('Modification Ã©vÃ©nement:', eventData);
                    const response = await fetch(`/api/events/${editingEvent.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(eventData)
                    });
                    const data = await response.json();
                    console.log('RÃ©ponse modification:', data);
                    
                    if (data.success) {
                        setShowModal(false);
                        setEditingEvent(null);
                        alert('âœ… Ã‰vÃ©nement modifiÃ© avec succÃ¨s !');
                        await loadEvents();
                        await loadStats();
                        await loadAnalytics();
                    } else {
                        alert('âŒ Erreur: ' + (data.error || 'Erreur inconnue'));
                    }
                } catch (error) {
                    console.error('Erreur modification:', error);
                    alert('âŒ Erreur lors de la modification: ' + error.message);
                }
            };

            const deleteEvent = async (eventId) => {
                if (confirm('ğŸ—‘ï¸ ÃŠtes-vous sÃ»r de vouloir supprimer cet Ã©vÃ©nement ?')) {
                    try {
                        const response = await fetch(`/api/events/${eventId}`, {
                            method: 'DELETE'
                        });
                        const data = await response.json();
                        if (data.success) {
                            setShowEventDetail(false);
                            alert('âœ… Ã‰vÃ©nement supprimÃ© !');
                            await loadEvents();
                            await loadStats();
                            await loadAnalytics();
                        } else {
                            alert('âŒ Erreur: ' + (data.error || 'Erreur inconnue'));
                        }
                    } catch (error) {
                        console.error('Erreur suppression:', error);
                        alert('âŒ Erreur lors de la suppression: ' + error.message);
                    }
                }
            };

            const handleEventClick = (event) => {
                setSelectedEvent(event);
                setShowEventDetail(true);
            };

            const handleEditEvent = (event) => {
                setEditingEvent(event);
                setShowEventDetail(false);
                setShowModal(true);
            };

            const resetFilters = () => {
                setSearchTerm('');
                setFilterType('');
                setFilterStatus('');
            };

            const generateMonthCalendar = () => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                const firstDay = new Date(year, month, 1);
                const startDate = new Date(firstDay);
                startDate.setDate(startDate.getDate() - firstDay.getDay());

                const days = [];
                for (let i = 0; i < 42; i++) {
                    const date = new Date(startDate);
                    date.setDate(startDate.getDate() + i);
                    days.push(date);
                }
                return days;
            };

            const generateWeekCalendar = () => {
                const startOfWeek = new Date(currentDate);
                const day = startOfWeek.getDay();
                const diff = startOfWeek.getDate() - day + (day === 0 ? -6 : 1);
                startOfWeek.setDate(diff);

                const days = [];
                for (let i = 0; i < 7; i++) {
                    const date = new Date(startOfWeek);
                    date.setDate(startOfWeek.getDate() + i);
                    days.push(date);
                }
                return days;
            };

            const navigatePrevious = () => {
                if (viewMode === 'month') {
                    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1));
                } else {
                    const newDate = new Date(currentDate);
                    newDate.setDate(currentDate.getDate() - 7);
                    setCurrentDate(newDate);
                }
            };

            const navigateNext = () => {
                if (viewMode === 'month') {
                    setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1));
                } else {
                    const newDate = new Date(currentDate);
                    newDate.setDate(currentDate.getDate() + 7);
                    setCurrentDate(newDate);
                }
            };

            const getEventClasses = (event) => {
                let typeClass = '';
                switch(event.type) {
                    case 'club': typeClass = 'event-club'; break;
                    case 'festival': typeClass = 'event-festival'; break;
                    case 'wedding': typeClass = 'event-wedding'; break;
                    case 'private': typeClass = 'event-private'; break;
                    case 'corporate': typeClass = 'event-corporate'; break;
                    default: typeClass = 'event-club';
                }

                let statusClass = '';
                switch(event.status) {
                    case 'confirmed': statusClass = 'event-confirmed'; break;
                    case 'pending': statusClass = 'event-pending'; break;
                    case 'cancelled': statusClass = 'event-cancelled'; break;
                    default: statusClass = 'event-confirmed';
                }

                return `${typeClass} ${statusClass}`;
            };

            const getEventIcon = (type) => {
                switch(type) {
                    case 'club': return 'ğŸ¢';
                    case 'festival': return 'ğŸª';
                    case 'wedding': return 'ğŸ’’';
                    case 'private': return 'ğŸ ';
                    case 'corporate': return 'ğŸ¢';
                    default: return 'ğŸµ';
                }
            };

            const days = viewMode === 'month' ? generateMonthCalendar() : generateWeekCalendar();
            const monthNames = ['Janvier', 'FÃ©vrier', 'Mars', 'Avril', 'Mai', 'Juin',
                              'Juillet', 'AoÃ»t', 'Septembre', 'Octobre', 'Novembre', 'DÃ©cembre'];
            const dayNames = ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi', 'Dimanche'];

            const getTitle = () => {
                if (viewMode === 'month') {
                    return `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
                } else {
                    const weekDays = generateWeekCalendar();
                    const start = weekDays[0];
                    const end = weekDays[6];
                    if (start.getMonth() === end.getMonth()) {
                        return `${start.getDate()}-${end.getDate()} ${monthNames[start.getMonth()]} ${start.getFullYear()}`;
                    } else {
                        return `${start.getDate()} ${monthNames[start.getMonth()]} - ${end.getDate()} ${monthNames[end.getMonth()]} ${start.getFullYear()}`;
                    }
                }
            };

            return (
                <div className="min-h-screen bg-slate-900 p-4">
                    <div className="flex justify-between items-center mb-6">
                        <div>
                            <h1 className="text-3xl font-bold text-white">ğŸµ DJ Calendar PRO+</h1>
                            <p className="text-slate-400">Gestion de planning professionnel avec analytics et notes DJ</p>
                        </div>
                        <button 
                            onClick={() => {setShowModal(true); setEditingEvent(null);}}
                            className="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg text-white font-semibold transition-all hover:scale-105"
                        >
                            â• Nouvel Ã©vÃ©nement
                        </button>
                    </div>

                    <div className="flex gap-2 mb-6">
                        <button 
                            onClick={() => setActiveTab('calendar')}
                            className={`tab-button px-4 py-2 rounded transition-all ${activeTab === 'calendar' ? 'active' : ''}`}
                        >
                            ğŸ“… Calendrier
                        </button>
                        <button 
                            onClick={() => setActiveTab('analytics')}
                            className={`tab-button px-4 py-2 rounded transition-all ${activeTab === 'analytics' ? 'active' : ''}`}
                        >
                            ğŸ“Š Analytics
                        </button>
                    </div>

                    {activeTab === 'calendar' && (
                        <>
                            <div className="bg-slate-800 p-4 rounded-lg mb-6">
                                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                    <div>
                                        <input
                                            type="text"
                                            placeholder="ğŸ” Rechercher un Ã©vÃ©nement ou lieu..."
                                            className="w-full p-2 bg-slate-700 rounded text-white"
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                        />
                                    </div>
                                    <div>
                                        <select
                                            className="w-full p-2 bg-slate-700 rounded text-white"
                                            value={filterType}
                                            onChange={(e) => setFilterType(e.target.value)}
                                        >
                                            <option value="">Tous les types</option>
                                            <option value="club">ğŸ¢ Club</option>
                                            <option value="festival">ğŸª Festival</option>
                                            <option value="wedding">ğŸ’’ Mariage</option>
                                            <option value="private">ğŸ  PrivÃ©</option>
                                            <option value="corporate">ğŸ¢ Corporate</option>
                                        </select>
                                    </div>
                                    <div>
                                        <select
                                            className="w-full p-2 bg-slate-700 rounded text-white"
                                            value={filterStatus}
                                            onChange={(e) => setFilterStatus(e.target.value)}
                                        >
                                            <option value="">Tous les statuts</option>
                                            <option value="confirmed">âœ… ConfirmÃ©</option>
                                            <option value="pending">â³ En attente</option>
                                            <option value="cancelled">âŒ AnnulÃ©</option>
                                        </select>
                                    </div>
                                    <div>
                                        <button
                                            onClick={resetFilters}
                                            className="w-full bg-slate-600 hover:bg-slate-500 p-2 rounded text-white transition-all"
                                        >
                                            ğŸ”„ RÃ©initialiser
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div className="flex gap-2 mb-4">
                                <button 
                                    onClick={() => setViewMode('month')}
                                    className={`view-button px-4 py-2 rounded transition-all ${viewMode === 'month' ? 'active' : ''}`}
                                >
                                    ğŸ“… Vue Mois
                                </button>
                                <button 
                                    onClick={() => setViewMode('week')}
                                    className={`view-button px-4 py-2 rounded transition-all ${viewMode === 'week' ? 'active' : ''}`}
                                >
                                    ğŸ“† Vue Semaine
                                </button>
                            </div>

                            <div className="flex justify-between items-center mb-4">
                                <button 
                                    onClick={navigatePrevious}
                                    className="bg-slate-700 hover:bg-slate-600 px-3 py-2 rounded transition-all"
                                >
                                    â† {viewMode === 'month' ? 'Mois prÃ©cÃ©dent' : 'Semaine prÃ©cÃ©dente'}
                                </button>
                                <h2 className="text-xl font-semibold">
                                    {getTitle()}
                                </h2>
                                <button 
                                    onClick={navigateNext}
                                    className="bg-slate-700 hover:bg-slate-600 px-3 py-2 rounded transition-all"
                                >
                                    {viewMode === 'month' ? 'Mois suivant' : 'Semaine suivante'} â†’
                                </button>
                            </div>

                            <div className="mb-4">
                                <div className="flex gap-4 mb-2 text-sm flex-wrap">
                                    <span className="font-semibold">Types :</span>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 rounded event-club"></div>
                                        <span>ğŸ¢ Club</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 rounded event-festival"></div>
                                        <span>ğŸª Festival</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 rounded event-wedding"></div>
                                        <span>ğŸ’’ Mariage</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 rounded event-private"></div>
                                        <span>ğŸ  PrivÃ©</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 rounded event-corporate"></div>
                                        <span>ğŸ¢ Corporate</span>
                                    </div>
                                </div>
                                <div className="flex gap-4 text-sm">
                                    <span className="font-semibold">Statuts :</span>
                                    <span>ğŸŸ¢ Trait plein = ConfirmÃ©</span>
                                    <span>ğŸŸ¡ Trait pointillÃ© = En attente</span>
                                    <span>âš« GrisÃ© = AnnulÃ©</span>
                                </div>
                            </div>

                            <div className="grid grid-cols-7 gap-1 mb-6">
                                {(viewMode === 'month' ? 
                                    ['Dimanche', 'Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi'] : 
                                    dayNames
                                ).map(day => (
                                    <div key={day} className="p-2 text-center font-semibold text-slate-300">
                                        {day}
                                    </div>
                                ))}
                                {days.map((day, index) => {
                                    const dayEvents = events.filter(event => 
                                        event.date === day.toISOString().split('T')[0]
                                    );
                                    const isCurrentMonth = viewMode === 'week' || day.getMonth() === currentDate.getMonth();
                                    const isToday = day.toDateString() === new Date().toDateString();
                                    
                                    return (
                                        <div 
                                            key={index}
                                            className={`${viewMode === 'month' ? 'calendar-day' : 'week-day'} p-2 
                                                       ${isCurrentMonth ? 'bg-slate-800' : 'bg-slate-900'} 
                                                       ${isToday ? 'ring-2 ring-purple-500' : ''}`}
                                        >
                                            <div className={`text-sm font-semibold ${isCurrentMonth ? 'text-white' : 'text-slate-500'}`}>
                                                {day.getDate()}
                                                {viewMode === 'week' && (
                                                    <div className="text-xs text-slate-400">
                                                        {dayNames[day.getDay() === 0 ? 6 : day.getDay() - 1]}
                                                    </div>
                                                )}
                                            </div>
                                            {dayEvents.map(event => (
                                                <div 
                                                    key={event.id} 
                                                    className={`event-item text-xs p-1 rounded mt-1 text-white ${getEventClasses(event)}`}
                                                    onClick={() => handleEventClick(event)}
                                                    title={`${event.title} - ${event.venueName} - ${event.fee}â‚¬`}
                                                >
                                                    {getEventIcon(event.type)} {event.title}
                                                </div>
                                            ))}
                                        </div>
                                    );
                                })}
                            </div>
                        </>
                    )}

                    {activeTab === 'analytics' && (
                        <div className="bg-slate-800 p-8 rounded-lg text-center">
                            <h3 className="text-xl font-bold mb-4">ğŸ“Š Analytics</h3>
                            <p className="text-slate-400">FonctionnalitÃ© en cours de dÃ©veloppement</p>
                        </div>
                    )}

                    <div className="grid grid-cols-4 gap-4">
                        <div className="bg-slate-800 p-4 rounded-lg">
                            <h3 className="text-slate-400">Total Ã©vÃ©nements</h3>
                            <p className="text-2xl font-bold text-white">{stats.total_events || 0}</p>
                        </div>
                        <div className="bg-slate-800 p-4 rounded-lg">
                            <h3 className="text-slate-400">ConfirmÃ©s</h3>
                            <p className="text-2xl font-bold text-green-400">{stats.confirmed_events || 0}</p>
                        </div>
                        <div className="bg-slate-800 p-4 rounded-lg">
                            <h3 className="text-slate-400">En attente</h3>
                            <p className="text-2xl font-bold text-yellow-400">{stats.pending_events || 0}</p>
                        </div>
                        <div className="bg-slate-800 p-4 rounded-lg">
                            <h3 className="text-slate-400">Revenus totaux</h3>
                            <p className="text-2xl font-bold text-purple-400">{stats.total_revenue || 0} â‚¬</p>
                        </div>
                    </div>

                    {showModal && (
                        <EventModal 
                            onClose={() => {setShowModal(false); setEditingEvent(null);}} 
                            onSave={editingEvent ? updateEvent : createEvent}
                            editingEvent={editingEvent}
                        />
                    )}
                    
                    {showEventDetail && selectedEvent && (
                        <EventDetailModal 
                            event={selectedEvent}
                            onClose={() => setShowEventDetail(false)}
                            onEdit={() => handleEditEvent(selectedEvent)}
                            onDelete={() => deleteEvent(selectedEvent.id)}
                        />
                    )}
                </div>
            );
        }

        function EventDetailModal({ event, onClose, onEdit, onDelete }) {
            const getStatusColor = (status) => {
                switch(status) {
                    case 'confirmed': return 'text-green-400';
                    case 'pending': return 'text-yellow-400';
                    case 'cancelled': return 'text-red-400';
                    default: return 'text-green-400';
                }
            };

            const getStatusText = (status) => {
                switch(status) {
                    case 'confirmed': return 'âœ… ConfirmÃ©';
                    case 'pending': return 'â³ En attente';
                    case 'cancelled': return 'âŒ AnnulÃ©';
                    default: return 'âœ… ConfirmÃ©';
                }
            };

            const getTypeText = (type) => {
                switch(type) {
                    case 'club': return 'ğŸ¢ Club';
                    case 'festival': return 'ğŸª Festival';
                    case 'wedding': return 'ğŸ’’ Mariage';
                    case 'private': return 'ğŸ  PrivÃ©';
                    case 'corporate': return 'ğŸ¢ Corporate';
                    default: return 'ğŸµ Autre';
                }
            };

            return (
                <div className="modal-overlay fixed inset-0 flex items-center justify-center z-50">
                    <div className="bg-slate-800 p-6 rounded-lg w-96 max-w-full max-h-96 overflow-y-auto">
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="text-xl font-bold">ğŸµ DÃ©tails de l'Ã©vÃ©nement</h3>
                            <button onClick={onClose} className="text-slate-400 hover:text-white text-xl">Ã—</button>
                        </div>
                        
                        <div className="space-y-3 text-sm">
                            <div><strong>Nom :</strong> {event.title}</div>
                            <div><strong>Date :</strong> {new Date(event.date).toLocaleDateString('fr-FR')}</div>
                            <div><strong>Horaires :</strong> {event.startTime} {event.endTime && `- ${event.endTime}`}</div>
                            <div><strong>Lieu :</strong> {event.venueName}</div>
                            {event.venueAddress && <div><strong>Adresse :</strong> {event.venueAddress}</div>}
                            <div><strong>Cachet :</strong> {event.fee} {event.currency}</div>
                            <div><strong>Type :</strong> {getTypeText(event.type)}</div>
                            <div className={getStatusColor(event.status)}><strong>Statut :</strong> {getStatusText(event.status)}</div>
                            {event.notes && <div><strong>Notes :</strong> {event.notes}</div>}
                            
                            {(event.techEquipment || event.techSetup || event.techPlaylist || event.techSetupTime || event.techNotes) && (
                                <>
                                    <hr className="border-slate-600 my-4" />
                                    <div className="text-purple-400 font-semibold">ğŸ§ Notes Techniques DJ</div>
                                    {event.techEquipment && <div><strong>ğŸ›ï¸ MatÃ©riel :</strong> {event.techEquipment}</div>}
                                    {event.techSetup && <div><strong>ğŸ”§ Setup :</strong> {event.techSetup}</div>}
                                    {event.techPlaylist && <div><strong>ğŸµ Playlist/Genre :</strong> {event.techPlaylist}</div>}
                                    {event.techSetupTime && <div><strong>â±ï¸ Temps setup :</strong> {event.techSetupTime} min</div>}
                                    {event.techNotes && <div><strong>ğŸ“ Notes tech :</strong> {event.techNotes}</div>}
                                </>
                            )}
                        </div>

                        <div className="flex gap-2 mt-6">
                            <button 
                                onClick={onEdit}
                                className="flex-1 bg-blue-600 hover:bg-blue-700 py-2 rounded text-white"
                            >
                                âœï¸ Modifier
                            </button>
                            <button 
                                onClick={onDelete}
                                className="flex-1 bg-red-600 hover:bg-red-700 py-2 rounded text-white"
                            >
                                ğŸ—‘ï¸ Supprimer
                            </button>
                            <button 
                                onClick={onClose}
                                className="flex-1 bg-slate-600 hover:bg-slate-500 py-2 rounded text-white"
                            >
                                Fermer
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        function EventModal({ onClose, onSave, editingEvent }) {
            const [activeTab, setActiveTab] = useState('basic');
            const [formData, setFormData] = useState({
                title: editingEvent?.title || '',
                date: editingEvent?.date || '',
                startTime: editingEvent?.startTime || '',
                endTime: editingEvent?.endTime || '',
                venueName: editingEvent?.venueName || '',
                venueAddress: editingEvent?.venueAddress || '',
                fee: editingEvent?.fee || '',
                currency: editingEvent?.currency || 'EUR',
                status: editingEvent?.status || 'confirmed',
                type: editingEvent?.type || 'club',
                notes: editingEvent?.notes || '',
                techEquipment: editingEvent?.techEquipment || '',
                techSetup: editingEvent?.techSetup || '',
                techPlaylist: editingEvent?.techPlaylist || '',
                techSetupTime: editingEvent?.techSetupTime || '',
                techNotes: editingEvent?.techNotes || ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                console.log('Soumission formulaire:', formData);
                if (formData.title && formData.date && formData.startTime && formData.venueName && formData.fee) {
                    onSave(formData);
                } else {
                    alert('âš ï¸ Veuillez remplir tous les champs obligatoires (*)');
                }
            };

            return (
                <div className="modal-overlay fixed inset-0 flex items-center justify-center z-50">
                    <div className="bg-slate-800 p-6 rounded-lg w-96 max-h-96 overflow-y-auto">
                        <h3 className="text-xl font-bold mb-4">
                            {editingEvent ? 'âœï¸ Modifier l\'Ã©vÃ©nement' : 'â• Nouvel Ã©vÃ©nement'}
                        </h3>
                        
                        <div className="flex gap-2 mb-4">
                            <button 
                                onClick={() => setActiveTab('basic')}
                                className={`tab-button px-3 py-1 rounded text-sm ${activeTab === 'basic' ? 'active' : ''}`}
                            >
                                ğŸ“‹ Infos de base
                            </button>
                            <button 
                                onClick={() => setActiveTab('tech')}
                                className={`tab-button px-3 py-1 rounded text-sm ${activeTab === 'tech' ? 'active' : ''}`}
                            >
                                ğŸ§ Notes DJ
                            </button>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-3">
                            {activeTab === 'basic' && (
                                <>
                                    <input 
                                        type="text" placeholder="Nom de l'Ã©vÃ©nement *" required
                                        className="w-full p-2 bg-slate-700 rounded text-white"
                                        value={formData.title} 
                                        onChange={(e) => setFormData({...formData, title: e.target.value})}
                                    />
                                    <input 
                                        type="date" required
                                        className="w-full p-2 bg-slate-700 rounded text-white"
                                        value={formData.date} 
                                        onChange={(e) => setFormData({...formData, date: e.target.value})}
                                    />
                                    <div className="grid grid-cols-2 gap-2">
                                        <input 
                                            type="time" placeholder="DÃ©but *" required
                                            className="p-2 bg-slate-700 rounded text-white"
                                            value={formData.startTime} 
                                            onChange={(e) => setFormData({...formData, startTime: e.target.value})}
                                        />
                                        <input 
                                            type="time" placeholder="Fin"
                                            className="p-2 bg-slate-700 rounded text-white"
                                            value={formData.endTime} 
                                            onChange={(e) => setFormData({...formData, endTime: e.target.value})}
                                        />
                                    </div>
                                    <input 
                                        type="text" placeholder="Nom du lieu *" required
                                        className="w-full p-2 bg-slate-700 rounded text-white"
                                        value={formData.venueName} 
                                        onChange={(e) => setFormData({...formData, venueName: e.target.value})}
                                    />
                                    <input 
                                        type="text" placeholder="Adresse du lieu"
                                        className="w-full p-2 bg-slate-700 rounded text-white"
                                        value={formData.venueAddress} 
                                        onChange={(e) => setFormData({...formData, venueAddress: e.target.value})}
                                    />
                                    <input 
                                        type="number" placeholder="Cachet *" required
                                        className="w-full p-2 bg-slate-700 rounded text-white"
                                        value={formData.fee} 
                                        onChange={(e) => setFormData({...formData, fee: e.target.value})}
                                    />
                                    <div className="grid grid-cols-2 gap-2">
                                        <select 
                                            className="p-2 bg-slate-700 rounded text-white"
                                            value={formData.type} 
                                            onChange={(e) => setFormData({...formData, type: e.target.value})}
                                        >
                                            <option value="club">ğŸ¢ Club</option>
                                            <option value="festival">ğŸª Festival</option>
                                            <option value="wedding">ğŸ’’ Mariage</option>
                                            <option value="private">ğŸ  PrivÃ©</option>
                                            <option value="corporate">ğŸ¢ Corporate</option>
                                        </select>
                                        <select 
                                            className="p-2 bg-slate-700 rounded text-white"
                                            value={formData.status} 
                                            onChange={(e) => setFormData({...formData, status: e.target.value})}
                                        >
                                            <option value="confirmed">âœ… ConfirmÃ©</option>
                                            <option value="pending">â³ En attente</option>
                                            <option value="cancelled">âŒ AnnulÃ©</option>
                                        </select>
                                    </div>
                                    <textarea 
                                        placeholder="Notes gÃ©nÃ©rales (optionnel)"
                                        className="w-full p-2 bg-slate-700 rounded text-white h-16"
                                        value={formData.notes} 
                                        onChange={(e) => setFormData({...formData, notes: e.target.value})}
                                    />
                                </>
                            )}

                            {activeTab === 'tech' && (
                                <>
                                    <textarea 
                                        placeholder="ğŸ›ï¸ MatÃ©riel nÃ©cessaire (CDJ, table de mixage, enceintes...)"
                                        className="w-full p-2 bg-slate-700 rounded text-white h-16"
                                        value={formData.techEquipment} 
                                        onChange={(e) => setFormData({...formData, techEquipment: e.target.value})}
                                    />
                                    <textarea 
                                        placeholder="ğŸ”§ Setup technique (configuration, branchements...)"
                                        className="w-full p-2 bg-slate-700 rounded text-white h-16"
                                        value={formData.techSetup} 
                                        onChange={(e) => setFormData({...formData, techSetup: e.target.value})}
                                    />
                                    <textarea 
                                        placeholder="ğŸµ Playlist/Genre musical (House, Techno, Top 40...)"
                                        className="w-full p-2 bg-slate-700 rounded text-white h-16"
                                        value={formData.techPlaylist} 
                                        onChange={(e) => setFormData({...formData, techPlaylist: e.target.value})}
                                    />
                                    <input 
                                        type="number" placeholder="â±ï¸ Temps de setup (en minutes)"
                                        className="w-full p-2 bg-slate-700 rounded text-white"
                                        value={formData.techSetupTime} 
                                        onChange={(e) => setFormData({...formData, techSetupTime: e.target.value})}
                                    />
                                    <textarea 
                                        placeholder="ğŸ“ Notes techniques spÃ©ciales"
                                        className="w-full p-2 bg-slate-700 rounded text-white h-16"
                                        value={formData.techNotes} 
                                        onChange={(e) => setFormData({...formData, techNotes: e.target.value})}
                                    />
                                </>
                            )}

                            <div className="flex gap-2">
                                <button type="button" onClick={onClose} className="flex-1 bg-slate-600 hover:bg-slate-500 py-2 rounded">
                                    Annuler
                                </button>
                                <button type="submit" className="flex-1 bg-purple-600 hover:bg-purple-700 py-2 rounded">
                                    {editingEvent ? 'âœï¸ Modifier' : 'â• CrÃ©er'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
